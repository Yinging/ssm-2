/*
Navicat MySQL Data Transfer

Source Server         : local
Source Server Version : 50715
Source Host           : localhost:3306
Source Database       : tyrion

Target Server Type    : MYSQL
Target Server Version : 50715
File Encoding         : 65001

Date: 2016-12-02 16:26:37
*/

SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for `blog`
-- ----------------------------
DROP TABLE IF EXISTS `blog`;
CREATE TABLE `blog` (
  `urlname` varchar(255) NOT NULL,
  `title` varchar(255) NOT NULL,
  `content` longtext NOT NULL,
  `type` varchar(2) NOT NULL COMMENT '0  java;\r\n1  android;\r\n2  php;\r\n3  随笔；',
  `year` varchar(4) NOT NULL,
  `month` varchar(2) NOT NULL,
  `day` varchar(2) NOT NULL,
  `date` datetime NOT NULL,
  `status` varchar(2) DEFAULT NULL COMMENT '0 正常； 1 删除',
  PRIMARY KEY (`urlname`,`year`,`month`,`day`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of blog
-- ----------------------------
INSERT INTO `blog` VALUES ('app_auto_start', '安卓开机自动启动app', '<p>1 新建一个类继承BroadcastReceiver, 监听系统的BOOT_COMPLETED</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#cc7832;\">package </span>com.zteits.parkingpay.receiver<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">import </span>android.content.BroadcastReceiver<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">import </span>android.content.Context<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">import </span>android.content.Intent<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">import </span>com.zteits.parkingpay.MainActivity<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#629755;font-style:italic;\">/**<br></span><span style=\"color:#629755;font-style:italic;\"> * Created by xiashuai on 10:24 2016/10/25.<br></span><span style=\"color:#629755;font-style:italic;\"> * Connection smay1227@163.com.<br></span><span style=\"color:#629755;font-style:italic;\"> */<br></span><span style=\"color:#629755;font-style:italic;\"><br></span><span style=\"color:#cc7832;\">public class </span>BootBroadcastReceiver <span style=\"color:#cc7832;\">extends </span>BroadcastReceiver {<br><br>   <span style=\"color:#cc7832;\">static final </span>String <span style=\"color:#9876aa;font-style:italic;\">ACTION </span>= <span style=\"color:#6a8759;\">\"android.intent.action.BOOT_COMPLETED\"</span><span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">   </span><span style=\"color:#bbb529;\">@Override<br></span><span style=\"color:#bbb529;\">   </span><span style=\"color:#cc7832;\">public void </span><span style=\"color:#ffc66d;\">onReceive</span>(Context context<span style=\"color:#cc7832;\">, </span>Intent intent) {<br>      <span style=\"color:#cc7832;\">if </span>(intent.getAction().equals(<span style=\"color:#9876aa;font-style:italic;\">ACTION</span>)){<br>         Intent mainActivityIntent = <span style=\"color:#cc7832;\">new </span>Intent(context<span style=\"color:#cc7832;\">, </span>MainActivity.<span style=\"color:#cc7832;\">class</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">         </span>mainActivityIntent.addFlags(Intent.<span style=\"color:#9876aa;font-style:italic;\">FLAG_ACTIVITY_NEW_TASK</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">         </span>context.startActivity(mainActivityIntent)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>}<br>   }<br>}<br></pre></pre><p>2 在配置文件中添加权限</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#e8bf6a;\">&lt;uses-permission </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.permission.RECEIVE_BOOT_COMPLETED\"</span><span style=\"color:#e8bf6a;\">/&gt;</span></pre></pre><p>3 在配置文件中注册receiver</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#e8bf6a;\">&lt;receiver </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\".receiver.BootBroadcastReceiver\"</span><span style=\"color:#e8bf6a;\">&gt;<br></span><span style=\"color:#e8bf6a;\">    &lt;intent-filter&gt;<br></span><span style=\"color:#e8bf6a;\">        &lt;action </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.intent.action.BOOT_COMPLETED\"</span><span style=\"color:#e8bf6a;\">/&gt;<br></span><span style=\"color:#e8bf6a;\">    &lt;/intent-filter&gt;<br></span><span style=\"color:#e8bf6a;\">&lt;/receiver&gt;</span></pre></pre><p>经过以上步骤就可以了</p><p><br></p>', '0', '2016', '10', '28', '2016-10-28 10:32:19', '0');
INSERT INTO `blog` VALUES ('blog', 'my blog', '<p>this is my blog.</p>', '0', '2016', '9', '30', '2016-09-30 16:00:44', '0');
INSERT INTO `blog` VALUES ('mifarecontrol', 'NFC Mifare卡读写封装类', '<h2>NFC Mifare卡读写封装类</h2><p>专门创建了MifareControl类实现了对Mifare卡读写的封装操作。此类是根据我们公司现有的业务逻辑改的，不过读写操作是通用的。</p><p>MifareControl里面主要实现了以下功能：</p><ul><li>判断卡里扇区的密码是否被修改</li><li>读取卡片的出场信息</li><li>制卡</li><li>读取车主卡号</li><li>修改扇区的默认密钥</li><li>读取和修改卡内余额</li></ul><p>首先应该拿到感应到的tag，来初始化MifareClassic</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#cc7832;\">public </span><span style=\"color:#ffc66d;\">MifareControl</span>(Tag tag){<br>   <span style=\"color:#cc7832;\">try </span>{<br>      <span style=\"color:#9876aa;\">mfc </span>= MifareClassic.<span style=\"font-style:italic;\">get</span>(tag)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span><span style=\"color:#9876aa;\">mfc</span>.connect()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>} <span style=\"color:#cc7832;\">catch </span>(IOException e) {<br>      e.printStackTrace()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br>}</pre></pre><p>当操作完成之后关闭连接</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#cc7832;\">public void </span><span style=\"color:#ffc66d;\">close</span>() <span style=\"color:#cc7832;\">throws </span>Exception{<br>   <span style=\"color:#cc7832;\">if </span>(<span style=\"color:#9876aa;\">mfc </span>!= <span style=\"color:#cc7832;\">null</span>) {<br>      <span style=\"color:#9876aa;\">mfc</span>.close()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br>}</pre></pre><h3>制卡</h3><p>修改第一扇区第二块写入车主卡号，注意要16个字节</p><p>修改第一扇区第三块写入卡片类型，卡内金额和日期，加起来要16字节，金额给了四个字节，这里做了移位操作。</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#cc7832;\">public void </span><span style=\"color:#ffc66d;\">makeCarCard</span>(IcCard icCard) <span style=\"color:#cc7832;\">throws </span>Exception{<br>   <span style=\"color:#cc7832;\">if </span>(<span style=\"color:#9876aa;\">mfc</span>.authenticateSectorWithKeyA(<span style=\"color:#9876aa;font-style:italic;\">SECTOR_ADDRESS</span><span style=\"color:#cc7832;\">, </span>MifareClassic.<span style=\"color:#9876aa;font-style:italic;\">KEY_DEFAULT</span>)){<br>      <span style=\"color:#808080;\">//</span><span style=\"color:#808080;font-family:\'宋体\';\">写入卡号<br></span><span style=\"color:#808080;font-family:\'宋体\';\">      </span><span style=\"color:#cc7832;\">byte</span>[] carNo = icCard.<span style=\"color:#9876aa;\">card_no</span>.getBytes()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span><span style=\"color:#9876aa;\">mfc</span>.writeBlock(<span style=\"color:#9876aa;font-style:italic;\">BLOCK_ONE</span><span style=\"color:#cc7832;\">, </span>carNo)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span><span style=\"color:#808080;\">//</span><span style=\"color:#808080;font-family:\'宋体\';\">写入卡的类型，金额和日期<br></span><span style=\"color:#808080;font-family:\'宋体\';\"><br></span><span style=\"color:#808080;font-family:\'宋体\';\">      </span><span style=\"color:#cc7832;\">byte</span>[] data = <span style=\"color:#9876aa;\">mfc</span>.readBlock(<span style=\"color:#9876aa;font-style:italic;\">BLOCK_TWO</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"MAKE_CARD\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"data length: \" </span>+ data.<span style=\"color:#9876aa;\">length</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"MAKE_CARD\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"data string: \" </span>+ <span style=\"color:#cc7832;\">new </span>String(data))<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">      byte</span>[] type = icCard.<span style=\"color:#9876aa;\">type</span>.getBytes()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>System.<span style=\"font-style:italic;\">arraycopy</span>(type<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">0</span><span style=\"color:#cc7832;\">, </span>data<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">0</span><span style=\"color:#cc7832;\">, </span>type.<span style=\"color:#9876aa;\">length</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">      byte</span>[] count = Converter.<span style=\"font-style:italic;\">intToByteArray</span>(Integer.<span style=\"font-style:italic;\">parseInt</span>(icCard.<span style=\"color:#9876aa;\">card_remain</span>))<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>System.<span style=\"font-style:italic;\">arraycopy</span>(count<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">0</span><span style=\"color:#cc7832;\">, </span>data<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">2</span><span style=\"color:#cc7832;\">, </span>count.<span style=\"color:#9876aa;\">length</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">      byte</span>[] date = icCard.<span style=\"color:#9876aa;\">card_date</span>.getBytes()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>System.<span style=\"font-style:italic;\">arraycopy</span>(date<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">0</span><span style=\"color:#cc7832;\">, </span>data<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">6</span><span style=\"color:#cc7832;\">, </span>date.<span style=\"color:#9876aa;\">length</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">      </span>Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"MAKE_CARD\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"data length: \" </span>+ data.<span style=\"color:#9876aa;\">length</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"MAKE_CARD\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"data string: \" </span>+ <span style=\"color:#cc7832;\">new </span>String(data))<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span><span style=\"color:#9876aa;\">mfc</span>.writeBlock(<span style=\"color:#9876aa;font-style:italic;\">BLOCK_TWO</span><span style=\"color:#cc7832;\">, </span>data)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span><span style=\"color:#808080;\">//</span><span style=\"color:#808080;font-family:\'宋体\';\">修改密码<br></span><span style=\"color:#808080;font-family:\'宋体\';\">      </span>changePwd()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<span style=\"color:#cc7832;\">else </span>{<br>      <span style=\"color:#cc7832;\">throw new </span>AppException(<span style=\"color:#6a8759;\">\"</span><span style=\"color:#6a8759;font-family:\'宋体\';\">制卡失败</span><span style=\"color:#6a8759;\">!\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br>}</pre></pre><p>修改默认扇区的密码</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#cc7832;\">private void </span><span style=\"color:#ffc66d;\">changePwd</span>() <span style=\"color:#cc7832;\">throws </span>Exception{<br>   <span style=\"color:#cc7832;\">if </span>(<span style=\"color:#9876aa;\">mfc</span>.authenticateSectorWithKeyA(<span style=\"color:#9876aa;font-style:italic;\">SECTOR_ADDRESS</span><span style=\"color:#cc7832;\">, </span>MifareClassic.<span style=\"color:#9876aa;font-style:italic;\">KEY_DEFAULT</span>)){<br>      <span style=\"color:#cc7832;\">byte</span>[] data = <span style=\"color:#9876aa;\">mfc</span>.readBlock(<span style=\"color:#9876aa;font-style:italic;\">BLOCK_THREE</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      byte</span>[] keyByte = Converter.<span style=\"font-style:italic;\">hexStringToBytes</span>(<span style=\"color:#9876aa;font-style:italic;\">key</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>System.<span style=\"font-style:italic;\">arraycopy</span>(keyByte<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">0</span><span style=\"color:#cc7832;\">, </span>data<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">0</span><span style=\"color:#cc7832;\">, </span>keyByte.<span style=\"color:#9876aa;\">length</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span><span style=\"color:#9876aa;\">mfc</span>.writeBlock(<span style=\"color:#9876aa;font-style:italic;\">BLOCK_THREE</span><span style=\"color:#cc7832;\">, </span>data)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<span style=\"color:#cc7832;\">else </span>{<br>      <span style=\"color:#cc7832;\">throw new </span>AppException(<span style=\"color:#6a8759;\">\"</span><span style=\"color:#6a8759;font-family:\'宋体\';\">更改默认秘钥失败</span><span style=\"color:#6a8759;\">!\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br>}</pre></pre><h3>读取和修改卡内余额</h3><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#cc7832;\">public </span>String <span style=\"color:#ffc66d;\">readRemainCount</span>(String cardNo) <span style=\"color:#cc7832;\">throws </span>Exception{<br>   String count<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   if </span>(!isTheSame(cardNo)){<br>      <span style=\"color:#cc7832;\">throw new </span>AppException(<span style=\"color:#6a8759;\">\"</span><span style=\"color:#6a8759;font-family:\'宋体\';\">传入的卡号与当前读取的卡号不匹配</span><span style=\"color:#6a8759;\">!\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br>   <span style=\"color:#cc7832;\">if </span>(<span style=\"color:#9876aa;\">mfc</span>.authenticateSectorWithKeyA(<span style=\"color:#9876aa;font-style:italic;\">SECTOR_ADDRESS</span><span style=\"color:#cc7832;\">, </span>Converter.<span style=\"font-style:italic;\">hexStringToBytes</span>(<span style=\"color:#9876aa;font-style:italic;\">key</span>))){<br>      <span style=\"color:#cc7832;\">byte</span>[] data = <span style=\"color:#9876aa;\">mfc</span>.readBlock(<span style=\"color:#9876aa;font-style:italic;\">BLOCK_TWO</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      byte</span>[] card_remain = <span style=\"color:#cc7832;\">new byte</span>[<span style=\"color:#6897bb;\">4</span>]<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>System.<span style=\"font-style:italic;\">arraycopy</span>(data<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">2</span><span style=\"color:#cc7832;\">, </span>card_remain<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">0</span><span style=\"color:#cc7832;\">, </span>card_remain.<span style=\"color:#9876aa;\">length</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>count = String.<span style=\"font-style:italic;\">valueOf</span>(Converter.<span style=\"font-style:italic;\">byteArrayToInt</span>(card_remain))<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<span style=\"color:#cc7832;\">else </span>{<br>      <span style=\"color:#cc7832;\">throw new </span>AppException(<span style=\"color:#6a8759;\">\"</span><span style=\"color:#6a8759;font-family:\'宋体\';\">读取余额失败</span><span style=\"color:#6a8759;\">!\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br>   <span style=\"color:#cc7832;\">return </span>count<span style=\"color:#cc7832;\">;<br></span>}</pre></pre><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#cc7832;\">public void </span><span style=\"color:#ffc66d;\">updateRemainCount</span>(String cardNo<span style=\"color:#cc7832;\">, </span>String remain_count) <span style=\"color:#cc7832;\">throws </span>Exception{<br>   <span style=\"color:#cc7832;\">if </span>(!isTheSame(cardNo)){<br>      <span style=\"color:#cc7832;\">throw new </span>AppException(<span style=\"color:#6a8759;\">\"</span><span style=\"color:#6a8759;font-family:\'宋体\';\">传入的卡号与当前读取的卡号不匹配</span><span style=\"color:#6a8759;\">!\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br>   <span style=\"color:#cc7832;\">if </span>(<span style=\"color:#9876aa;\">mfc</span>.authenticateSectorWithKeyA(<span style=\"color:#9876aa;font-style:italic;\">SECTOR_ADDRESS</span><span style=\"color:#cc7832;\">, </span>Converter.<span style=\"font-style:italic;\">hexStringToBytes</span>(<span style=\"color:#9876aa;font-style:italic;\">key</span>))){<br>      <span style=\"color:#cc7832;\">byte</span>[] data = <span style=\"color:#9876aa;\">mfc</span>.readBlock(<span style=\"color:#9876aa;font-style:italic;\">BLOCK_TWO</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      byte</span>[] price = Converter.<span style=\"font-style:italic;\">intToByteArray</span>(Integer.<span style=\"font-style:italic;\">parseInt</span>(remain_count))<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>System.<span style=\"font-style:italic;\">arraycopy</span>(price<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">0</span><span style=\"color:#cc7832;\">, </span>data<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">2</span><span style=\"color:#cc7832;\">, </span>price.<span style=\"color:#9876aa;\">length</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span><span style=\"color:#9876aa;\">mfc</span>.writeBlock(<span style=\"color:#9876aa;font-style:italic;\">BLOCK_TWO</span><span style=\"color:#cc7832;\">, </span>data)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<span style=\"color:#cc7832;\">else </span>{<br>      <span style=\"color:#cc7832;\">throw new </span>AppException(<span style=\"color:#6a8759;\">\"</span><span style=\"color:#6a8759;font-family:\'宋体\';\">读取余额失败</span><span style=\"color:#6a8759;\">!\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br><br>}</pre></pre><p>主要就是读写操作，详细的信息可以看demo。</p><p><br></p>', '0', '2016', '11', '16', '2016-11-16 14:54:07', '0');
INSERT INTO `blog` VALUES ('nfc_demo', 'android nfc demo', '<p></p><h2>android nfc demo</h2>\n<p>我这边只有mifare卡，这个demo也是针对m1卡编写的</p>\n<p>当android扫描到NFC标签时，会自动寻找最适合的Activity来处理这个TAG，如果有多个Activity满足条件的话，会让用户来选择到底使用哪一个Activity来处理\n但我们的业务逻辑会有好多activity要对卡里的内容进行操作，如果让用户自己选择的话会有点不友好。</p>\n<p>我的处理是把我们业务上所有对卡的处理，全都放到一个activity里，setResult来把处理结果以及查询信息返回到调用activity那里。处理NFC的activity做成dialog\n样式的，提醒将卡片靠近。</p>\n<p>M1卡有16个扇区，64块，每个扇区有4块，第一扇区第1块，只能执行读操作，不能进行写操作。每个扇区都是独立的，每个扇区的第四块是存放各个扇区密码的地方。\n我们能进行操作的是第一扇区的第2，3块，以及其他扇区的第1，2，3块。</p>\n<p>这个demo主要改的信息为：</p>\n\n   <ul>\n      <li>获取卡片的默认出场信息</li>\n      <li>修改第一扇区的默认密码</li>\n      <li>第一扇区第2块写入自己定义的卡号</li>\n      <li>第一扇区第3块写入卡片类型，金额，日期</li>\n      <li>修改金额，充值或者刷卡</li>\n   </ul>\n<a href=\"https://github.com/smay1227/NFCDEMO\" target=\"_blank\">demo地址</a><p></p><p><br>\n\n</p>', '0', '2016', '11', '16', '2016-11-16 11:12:11', '0');
INSERT INTO `blog` VALUES ('nfc_settings', 'NFC Android机器操作Mifare卡具体配置', '<h2>android 实现NFC功能具体配置</h2><h3>android manifest配置</h3><p>首先声明nfc使用权限</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#e8bf6a;\">&lt;uses-permission </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.permission.NFC\"</span><span style=\"color:#e8bf6a;\">/&gt;</span></pre></pre><p>硬件功能：表明应用需要用的硬件功能</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#e8bf6a;\">&lt;uses-feature<br></span><span style=\"color:#e8bf6a;\">    </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.hardware.nfc\"<br></span><span style=\"color:#6a8759;\">    </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:required=</span><span style=\"color:#6a8759;\">\"true\"</span><span style=\"color:#e8bf6a;\">/&gt;</span></pre></pre><p>创建一个activity用来处理机器扫描到nfc的信息，并在activity的intent-filter里声明要处理的标签类型，activity的launchMode设为singleTop，demo里面为了用户友好，把activity的样式设为了dialog类型。</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#e8bf6a;\">&lt;activity<br></span><span style=\"color:#e8bf6a;\">    </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\".activity.LogicActivity\"<br></span><span style=\"color:#6a8759;\">    </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:launchMode=</span><span style=\"color:#6a8759;\">\"singleTop\"<br></span><span style=\"color:#6a8759;\">    </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:screenOrientation=</span><span style=\"color:#6a8759;\">\"portrait\"<br></span><span style=\"color:#6a8759;\">    </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:theme=</span><span style=\"color:#6a8759;\">\"@style/DialogStyle\"</span><span style=\"color:#e8bf6a;\">&gt;<br></span><span style=\"color:#e8bf6a;\">    &lt;intent-filter&gt;<br></span><span style=\"color:#e8bf6a;\">        &lt;action </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.nfc.action.NDEF_DISCOVERED\"</span><span style=\"color:#e8bf6a;\">/&gt;<br></span><span style=\"color:#e8bf6a;\">        &lt;data </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:mimeType=</span><span style=\"color:#6a8759;\">\"text/plain\"</span><span style=\"color:#e8bf6a;\">/&gt;<br></span><span style=\"color:#e8bf6a;\">    &lt;/intent-filter&gt;<br></span><span style=\"color:#e8bf6a;\"><br></span><span style=\"color:#e8bf6a;\">    &lt;intent-filter&gt;<br></span><span style=\"color:#e8bf6a;\">        &lt;action </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.nfc.action.TAG_DISCOVERED\"</span><span style=\"color:#e8bf6a;\">&gt;<br></span><span style=\"color:#e8bf6a;\">        &lt;/action&gt;<br></span><span style=\"color:#e8bf6a;\">        &lt;category </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.intent.category.DEFAULT\"</span><span style=\"color:#e8bf6a;\">&gt;<br></span><span style=\"color:#e8bf6a;\">        &lt;/category&gt;<br></span><span style=\"color:#e8bf6a;\">    &lt;/intent-filter&gt;<br></span><span style=\"color:#e8bf6a;\"><br></span><span style=\"color:#e8bf6a;\">    &lt;intent-filter&gt;<br></span><span style=\"color:#e8bf6a;\">        &lt;action </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.nfc.action.TECH_DISCOVERED\"</span><span style=\"color:#e8bf6a;\">/&gt;<br></span><span style=\"color:#e8bf6a;\">    &lt;/intent-filter&gt;<br></span><span style=\"color:#e8bf6a;\"><br></span><span style=\"color:#e8bf6a;\">    &lt;meta-data<br></span><span style=\"color:#e8bf6a;\">        </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.nfc.action.TECH_DISCOVERED\"<br></span><span style=\"color:#6a8759;\">        </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:resource=</span><span style=\"color:#6a8759;\">\"@xml/nfc_tech_filter\"</span><span style=\"color:#e8bf6a;\">/&gt;<br></span><span style=\"color:#e8bf6a;\"><br></span><span style=\"color:#e8bf6a;\">&lt;/activity&gt;</span></pre></pre><p>创建meta-data里nfc_tech_filter里的内容</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#e8bf6a;\">&lt;?</span><span style=\"color:#bababa;\">xml version=</span><span style=\"color:#6a8759;\">\"1.0\" </span><span style=\"color:#bababa;\">encoding=</span><span style=\"color:#6a8759;\">\"utf-8\"</span><span style=\"color:#e8bf6a;\">?&gt;<br></span><span style=\"color:#e8bf6a;\">&lt;resources </span><span style=\"color:#bababa;\">xmlns:</span><span style=\"color:#9876aa;\">xliff</span><span style=\"color:#bababa;\">=</span><span style=\"color:#6a8759;\">\"urn:oasis:names:tc:xliff:document:1.2\"</span><span style=\"color:#e8bf6a;\">&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.IsoDep<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.NfcA<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.NfcB<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.NfcF<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.NfcV<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.Ndef<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.NdefFormatable<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.MifareClassic<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.MifareUltralight<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">&lt;/resources&gt;</span></pre></pre><h3>LogicActivity 逻辑处理</h3><p>系统扫描到NFC标签时都会调用LogicActivity，并在onNewIntent里对NFC tag里的信息进行处理。</p><p>这边是判断了LogicActivity的启动来源，不同来源对应不同的处理事件，当次activity不是人为启动而是系统扫描到nfc标签时自动打开的时候，此activity会自己关闭掉。</p><p>最后通过返回码，返回到调用者activity。</p><p>具体的处理逻辑如下：</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#cc7832;\">private void </span><span style=\"color:#ffc66d;\">processIntent</span>(Intent intent){<br>   <span style=\"color:#cc7832;\">if </span>(<span style=\"color:#9876aa;\">mFrom </span>== -<span style=\"color:#6897bb;\">1</span>){<br>      finish()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      return;<br></span><span style=\"color:#cc7832;\">   </span>}<br>   <span style=\"color:#cc7832;\">if </span>(<span style=\"color:#9876aa;\">mIntent </span>== <span style=\"color:#cc7832;\">null</span>){<br>      <span style=\"color:#cc7832;\">return;<br></span><span style=\"color:#cc7832;\">   </span>}<br>   <span style=\"color:#808080;\">//</span><span style=\"color:#808080;font-family:\'宋体\';\">取出封装在</span><span style=\"color:#808080;\">intent</span><span style=\"color:#808080;font-family:\'宋体\';\">中的</span><span style=\"color:#808080;\">TAG<br></span><span style=\"color:#808080;\">   </span>Tag tagFromIntent = intent.getParcelableExtra(NfcAdapter.<span style=\"color:#9876aa;font-style:italic;\">EXTRA_TAG</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   for </span>(String tech : tagFromIntent.getTechList()) {<br>      System.<span style=\"color:#9876aa;font-style:italic;\">out</span>.println(tech)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br><br>   MifareControl mc = <span style=\"color:#cc7832;\">new </span>MifareControl(tagFromIntent)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">   try </span>{<br>      Intent intentResult = <span style=\"color:#cc7832;\">new </span>Intent()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      switch </span>(<span style=\"color:#9876aa;\">mFrom</span>){<br>         <span style=\"color:#cc7832;\">case </span>CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_CHARGE</span>:<br>            Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"LogicActivity\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"TAG_CHARGE\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            </span>mc.updateRemainCount(<span style=\"color:#9876aa;\">cardNo</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#9876aa;\">cardCount</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>intentResult.putExtra(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_CARD_CHARGE</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"0\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>setResult(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_CHARGE</span><span style=\"color:#cc7832;\">, </span>intentResult)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>finish()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            break;<br></span><span style=\"color:#cc7832;\">         case </span>CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_PAY</span>:<br>            Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"LogicActivity\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"TAG_PAY\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            </span>IcCard icCard = mc.readIcCard()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            </span>intentResult.putExtra(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_CARD_NO</span><span style=\"color:#cc7832;\">, </span>icCard.<span style=\"color:#9876aa;\">card_no</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>intentResult.putExtra(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_CARD_COUNT</span><span style=\"color:#cc7832;\">, </span>icCard.<span style=\"color:#9876aa;\">card_remain</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>intentResult.putExtra(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_CARD_DATE</span><span style=\"color:#cc7832;\">, </span>icCard.<span style=\"color:#9876aa;\">card_date</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>setResult(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_PAY</span><span style=\"color:#cc7832;\">, </span>intentResult)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>finish()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            break;<br></span><span style=\"color:#cc7832;\">         case </span>CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_READ_CARD_NO</span>:<br>            Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"LogicActivity\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"TAG_READ_CARD_NO\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            if </span>(!mc.isBlankCard()){<br>               intentResult.putExtra(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_BLANK_CARD</span><span style=\"color:#cc7832;\">, false</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">               </span>setResult(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_READ_CARD_NO</span><span style=\"color:#cc7832;\">, </span>intentResult)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">               </span>finish()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">               break;<br></span><span style=\"color:#cc7832;\">            </span>}<br><br>            String defaultCarNo = mc.readDefaultCarCardNo()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"LogicActivity\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;defaultCarNo: \" </span>+ defaultCarNo)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            </span>intentResult.putExtra(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_CARD_DEFAULT_NO</span><span style=\"color:#cc7832;\">, </span>defaultCarNo)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>setResult(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_READ_CARD_NO</span><span style=\"color:#cc7832;\">, </span>intentResult)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>finish()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            break;<br></span><span style=\"color:#cc7832;\">         case </span>CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_SELL</span>:<br>            Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"LogicActivity\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"TAG_SELL\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            </span>IcCard icCardSell = <span style=\"color:#cc7832;\">new </span>IcCard()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>icCardSell.<span style=\"color:#9876aa;\">card_no </span>= <span style=\"color:#9876aa;\">cardNo</span><span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>icCardSell.<span style=\"color:#9876aa;\">type </span>= <span style=\"color:#9876aa;\">cardType</span><span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>icCardSell.<span style=\"color:#9876aa;\">card_remain </span>= <span style=\"color:#9876aa;\">cardCount</span><span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>icCardSell.<span style=\"color:#9876aa;\">card_date </span>= <span style=\"color:#9876aa;\">cardDate</span><span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            </span>mc.makeCarCard(icCardSell)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            </span>intentResult.putExtra(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_CARD_MAKE</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"0\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>setResult(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_SELL</span><span style=\"color:#cc7832;\">, </span>intentResult)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>finish()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            break;<br></span><span style=\"color:#cc7832;\">         case </span>-<span style=\"color:#6897bb;\">1</span>:<br>            Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"LogicActivity\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"-1\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>finish()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            break;<br></span><span style=\"color:#cc7832;\">      </span>}<br><br>      mc.close()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">   </span>} <span style=\"color:#cc7832;\">catch </span>(Exception e) {<br>      Toast.<span style=\"font-style:italic;\">makeText</span>(LogicActivity.<span style=\"color:#cc7832;\">this, </span><span style=\"color:#6a8759;\">\"</span><span style=\"color:#6a8759;font-family:\'宋体\';\">读取车主卡失败</span><span style=\"color:#6a8759;\">\"</span><span style=\"color:#cc7832;\">, </span>Toast.<span style=\"color:#9876aa;font-style:italic;\">LENGTH_SHORT</span>).show()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>finish()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>e.printStackTrace()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br>}</pre></pre><p><br></p><p><br></p><p><br></p>', '0', '2016', '11', '16', '2016-11-16 11:45:31', '0');
INSERT INTO `blog` VALUES ('nvmw_dev', 'windows下使用nvmw管理node采坑之旅', '<h2>windows下使用nvmw管理node.js踩坑</h2><h4>首先下载<a href=\"https://github.com/hakobera/nvmw\">nvmw</a></h4><p>根据下载的位置配置path环境变量</p><p><br></p><p>替换<span style=\"color: rgb(51, 51, 51); font-family: \'Helvetica Neue\', Helvetica, Arial, \'PingFang SC\', \'Hiragino Sans GB\', \'WenQuanYi Micro Hei\', \'Microsoft Yahei\', sans-serif; line-height: 22.4px;\">nvmw.bat为：</span></p><pre><font face=\"Helvetica Neue, Helvetica, Arial, PingFang SC, Hiragino Sans GB, WenQuanYi Micro Hei, Microsoft Yahei, sans-serif\"><span style=\"line-height: 22.4px;\">@echo off\n\nif not defined NVMW_HOME (\n  set \"NVMW_HOME=%~dp0\"\n)\n\nif not defined PATH_ORG (\n  set \"PATH_ORG=%PATH%\"\n)\n\nset IS64=FALSE\nif exist \"%PROGRAMFILES(X86)%\" (\n  set IS64=TRUE\n)\n\nif %IS64% == TRUE (\n  set OS_ARCH=x64\n) else (\n  set OS_ARCH=x32\n)\n\nif not defined NVMW_NODEJS_ORG_MIRROR (\n  set \"NVMW_NODEJS_ORG_MIRROR=https://nodejs.org/dist\"\n)\n\nif not defined NVMW_IOJS_ORG_MIRROR (\n  set \"NVMW_IOJS_ORG_MIRROR=https://iojs.org/dist\"\n)\n\nif \"%1\" == \"install\" if not \"%2\" == \"\" (\n  call :install %2 %3\n  if not ERRORLEVEL == 1 call :use %2 %3\n  exit /b %ERRORLEVEL%\n)\n\nif \"%1\" == \"use\" if not \"%2\" == \"\" (\n  call :use %2 %3\n  exit /b %ERRORLEVEL%\n)\n\nif \"%1\" == \"ls\" (\n  call :ls\n  exit /b %ERRORLEVEL%\n)\n\nif \"%1\" == \"uninstall\" if not \"%2\" == \"\" (\n  call :uninstall %2 %3\n  exit /b %ERRORLEVEL%\n)\n\ncall :help\nexit /b %ERRORLEVEL%\n\n::===========================================================\n:: help : Show help message\n::===========================================================\n:help\necho;\necho Node Version Manager for Windows\necho;\necho Usage:\necho   nvmw help                          Show this message\necho   nvmw install [version] [arch]      Download and install a [version]\necho                                        for [arch] architecture (optional)\necho   nvmw uninstall [version]           Uninstall a [version]\necho   nvmw use [version]                 Modify PATH to use [version]\necho   nvmw ls                            List installed versions\necho;\necho Example:\necho   nvmw install v0.10.21        Install a specific version number of node.js\necho   nvmw use v0.10.21            Use the specific version\necho   nvmw install iojs            Install the latest version of io.js\necho   nvmw install iojs-v1.0.2     Install a specific version number of io.js\necho   nvmw use iojs-v1.0.2         Use the specific version io.js\necho;\necho   nvmw install v0.10.35 x86    Install a 32-bit version\nexit /b 0\n\n::===========================================================\n:: install : Install specified version node and npm\n::===========================================================\n:install\nsetlocal\n\nset ARCH=%OS_ARCH%\n\nif not \"%2\" == \"\" (\n  set ARCH=%2\n  :: x86, ia32 alias x32\n  if \"%2\" == \"x86\" (\n    set ARCH=x32\n  )\n  if \"%2\" == \"ia32\" (\n    set ARCH=x32\n  )\n)\n\nset NODE_TYPE=node\nset NODE_VERSION=%1\n\n:: nvmw install iojs-v1.0.2\nif \"%NODE_VERSION:~4,1%\" == \"-\" (\n  for /f \"tokens=1,2,* delims=-\" %%a in (\"%NODE_VERSION%\") do (\n    set NODE_TYPE=%%a\n    set NODE_VERSION=%%b\n  )\n)\n\n:: nvmw install iojs\nif %NODE_VERSION% == iojs (\n  set NODE_TYPE=iojs\n  set NODE_VERSION=latest\n)\n\n:: nvmw install node\nif %NODE_VERSION% == node (\n  set NODE_TYPE=node\n  set NODE_VERSION=latest\n)\n\n:: iojs-1.0.0, iojs-latest\nif not %NODE_VERSION:~0,1% == v if not %NODE_VERSION:~0,1% == l (\n  set NODE_VERSION=v%NODE_VERSION%\n)\n\nif %NODE_TYPE% == iojs (\n  set DIST_URL=%%\n  if %ARCH% == x32 (\n    set NODE_EXE_URL=%NVMW_IOJS_ORG_MIRROR%/%NODE_VERSION%/win-x86/iojs.exe\n  ) else (\n    set NODE_EXE_URL=%NVMW_IOJS_ORG_MIRROR%/%NODE_VERSION%/win-x64/iojs.exe\n  )\n) else if %NODE_VERSION:~0,1% == 0 (\n  if %ARCH% == x32 (\n    set NODE_EXE_URL=%NVMW_NODEJS_ORG_MIRROR%/%NODE_VERSION%/node.exe\n  ) else (\n    set NODE_EXE_URL=%NVMW_NODEJS_ORG_MIRROR%/%NODE_VERSION%/x64/node.exe\n  )\n) else (\n  if %ARCH% == x32 (\n    set NODE_EXE_URL=%NVMW_NODEJS_ORG_MIRROR%/%NODE_VERSION%/win-x86/node.exe\n  ) else (\n    set NODE_EXE_URL=%NVMW_NODEJS_ORG_MIRROR%/%NODE_VERSION%/win-x64/node.exe\n  )\n)\n\nset \"NODE_HOME=%NVMW_HOME%%NODE_VERSION%\"\nif %NODE_TYPE% == iojs (\n  set \"NODE_HOME=%NVMW_HOME%%NODE_TYPE%\\%NODE_VERSION%\"\n)\n\nif not %ARCH% == %OS_ARCH% (\n  set \"NODE_HOME=%NODE_HOME%-%ARCH%\"\n)\n\nset \"NODE_EXE_FILE=%NODE_HOME%\\%NODE_TYPE%.exe\"\nset \"NPM_ZIP_FILE=%NODE_HOME%\\npm.zip\"\n\nif exist \"%NODE_EXE_FILE%\" (\n  endlocal\n  echo \"%NODE_TYPE%/%NODE_VERSION% (%ARCH%)\" already exists, please uninstall it first\n  exit /b 1\n)\n\nmkdir \"%NODE_HOME%\"\n\necho Start installing %NODE_TYPE%/%NODE_VERSION% (%ARCH%) to %NODE_HOME%\n\ncscript //nologo \"%NVMW_HOME%\\fget.js\" %NODE_EXE_URL% \"%NODE_EXE_FILE%\"\n\nif not exist \"%NODE_EXE_FILE%\" (\n  echo Download %NODE_EXE_FILE% from %NODE_EXE_URL% failed\n  goto install_error\n) else (\n  if %NODE_TYPE% == iojs (\n    copy \"%NVMW_HOME%\\alias-node.cmd\" \"%NODE_HOME%\\node.cmd\"\n  )\n\n  echo Start install npm\n\n  \"%NODE_EXE_FILE%\" \"%NVMW_HOME%\\get_npm.js\" \"%NODE_HOME%\" \"%NODE_TYPE%/%NODE_VERSION%\"\n  if not exist \"%NPM_ZIP_FILE%\" goto install_error\n\n  set \"CD_ORG=%CD%\"\n  %~d0\n  cd \"%NODE_HOME%\"\n  echo Start unzip \"%NPM_ZIP_FILE%\" to \"%NODE_HOME%\"\n  cscript //nologo \"%NVMW_HOME%\\unzip.js\" \"%NPM_ZIP_FILE%\" \"%NODE_HOME%\"\n  mkdir \"%NODE_HOME%\\node_modules\"\n  rmdir /s /q \"%NODE_HOME%\\node_modules\\npm\"\n  move npm-* \"%NODE_HOME%\\node_modules\\npm\"\n  copy \"%NODE_HOME%\\node_modules\\npm\\bin\\npm.cmd\" \"%NODE_HOME%\\npm.cmd\"\n  cd \"%CD_ORG%\"\n  if not exist \"%NODE_HOME%\\npm.cmd\" goto install_error\n  echo npm install ok\n\n  echo Finished\n  endlocal\n  exit /b 0\n)\n:install_error\n  rd /Q /S \"%NODE_HOME%\"\n  endlocal\n  exit /b 1\n\n::===========================================================\n:: uninstall : Uninstall specified version\n::===========================================================\n:uninstall\nsetlocal\n\nset ARCH=%OS_ARCH%\n\nif not \"%2\" == \"\" (\n  set ARCH=%2\n  :: x86, ia32 alias x32\n  if \"%2\" == \"x86\" (\n    set ARCH=x32\n  )\n  if \"%2\" == \"ia32\" (\n    set ARCH=x32\n  )\n)\n\nset NODE_TYPE=node\nset NODE_VERSION=%1\n\nif \"%NODE_VERSION:~4,1%\" == \"-\" (\n  for /f \"tokens=1,2,* delims=-\" %%a in (\"%NODE_VERSION%\") do (\n    set NODE_TYPE=%%a\n    set NODE_VERSION=%%b\n  )\n)\n\n:: nvmw uninstall iojs\nif %NODE_VERSION% == iojs (\n  set NODE_TYPE=iojs\n  set NODE_VERSION=latest\n)\n\n:: nvmw uninstall node\nif %NODE_VERSION% == node (\n  set NODE_TYPE=node\n  set NODE_VERSION=latest\n)\n\nif not %NODE_VERSION:~0,1% == v if not %NODE_VERSION:~0,1% == l (\n  set NODE_VERSION=v%NODE_VERSION%\n)\n\nif \"%NVMW_CURRENT_TYPE%\" == \"%NODE_TYPE%\" if \"%NVMW_CURRENT%\" == \"%NODE_VERSION%\" if \"%NVMW_CURRENT_ARCH%\" == \"%ARCH%\" (\n  echo Cannot uninstall currently-active %NODE_TYPE%/%NODE_VERSION% %ARCH%\n  exit /b 1\n)\n\nset \"NODE_HOME=%NVMW_HOME%%NODE_VERSION%\"\nif %NODE_TYPE% == iojs (\n  set \"NODE_HOME=%NVMW_HOME%%NODE_TYPE%\\%NODE_VERSION%\"\n)\n\nif not %ARCH% == %OS_ARCH% (\n  set \"NODE_HOME=%NODE_HOME%-%ARCH%\"\n)\n\nif not exist \"%NODE_HOME%\" (\n  echo %NODE_TYPE%/%NODE_VERSION% %ARCH% is not installed\n  exit /b 1\n) else (\n  rd /Q /S \"%NODE_HOME%\"\n  if ERRORLEVEL == 1 (\n    echo Cannot uninstall %NODE_TYPE%/%NODE_VERSION% %ARCH%\n    exit /b 1\n  ) else (\n    echo Uninstalled %NODE_TYPE%/%NODE_VERSION% %ARCH%\n    endlocal\n    exit /b 0\n  )\n)\n\n::===========================================================\n:: use : Change current version\n::===========================================================\n:use\nsetlocal\n\nset ARCH=%OS_ARCH%\n\nif not \"%2\" == \"\" (\n  set ARCH=%2\n  :: x86, ia32 alias x32\n  if \"%2\" == \"x86\" (\n    set ARCH=x32\n  )\n  if \"%2\" == \"ia32\" (\n    set ARCH=x32\n  )\n)\n\nset NODE_TYPE=node\nset NODE_VERSION=%1\n\nif \"%NODE_VERSION:~4,1%\" == \"-\" (\n  for /f \"tokens=1,2,* delims=-\" %%a in (\"%NODE_VERSION%\") do (\n    set NODE_TYPE=%%a\n    set NODE_VERSION=%%b\n  )\n)\n\n:: nvmw use iojs\nif %NODE_VERSION% == iojs (\n  set NODE_TYPE=iojs\n  set NODE_VERSION=latest\n)\n\n:: nvmw use node\nif %NODE_VERSION% == node (\n  set NODE_TYPE=node\n  set NODE_VERSION=latest\n)\n\nif not %NODE_VERSION:~0,1% == v if not %NODE_VERSION:~0,1% == l (\n  set NODE_VERSION=v%NODE_VERSION%\n)\n\nset \"NODE_HOME=%NVMW_HOME%%NODE_VERSION%\"\nif %NODE_TYPE% == iojs (\n  set \"NODE_HOME=%NVMW_HOME%%NODE_TYPE%\\%NODE_VERSION%\"\n)\n\nif not %ARCH% == %OS_ARCH% (\n  set \"NODE_HOME=%NODE_HOME%-%ARCH%\"\n)\n\nif not exist \"%NODE_HOME%\" (\n  echo %NODE_TYPE%/%NODE_VERSION% is not installed\n  exit /b 1\n)\n\nendlocal\n\nset NVMW_CURRENT_ARCH=%OS_ARCH%\nif not \"%2\" == \"\" (\n  set NVMW_CURRENT_ARCH=%2\n  :: x86, ia32 alias x32\n  if \"%2\" == \"x86\" (\n    set NVMW_CURRENT_ARCH=x32\n  )\n  if \"%2\" == \"ia32\" (\n    set NVMW_CURRENT_ARCH=x32\n  )\n)\n\nset NVMW_CURRENT_TYPE=node\nset NVMW_CURRENT=%1\nif \"%NVMW_CURRENT:~4,1%\" == \"-\" (\n  for /f \"tokens=1,2,* delims=-\" %%a in (\"%NVMW_CURRENT%\") do (\n    set NVMW_CURRENT_TYPE=%%a\n    set NVMW_CURRENT=%%b\n  )\n)\n\nif %NVMW_CURRENT% == iojs (\n  set NVMW_CURRENT_TYPE=iojs\n  set NVMW_CURRENT=latest\n)\n\nif %NVMW_CURRENT% == node (\n  set NVMW_CURRENT_TYPE=node\n  set NVMW_CURRENT=latest\n)\n\nif not %NVMW_CURRENT:~0,1% == v if not %NVMW_CURRENT:~0,1% == l (\n  set NVMW_CURRENT=v%NVMW_CURRENT%\n)\n\necho Now using %NVMW_CURRENT_TYPE% %NVMW_CURRENT% %NVMW_CURRENT_ARCH%\n\nset \"NODE_HOME=%NVMW_HOME%%NODE_VERSION%\"\nif %NVMW_CURRENT_TYPE% == iojs (\n  set \"NODE_HOME=%NVMW_HOME%%NODE_TYPE%\\%NODE_VERSION%\"\n)\n\nif not %NVMW_CURRENT_ARCH% == %OS_ARCH% (\n  set NVMW_CURRENT_ARCH_PADDING=-%NVMW_CURRENT_ARCH%\n) else (\n  set NVMW_CURRENT_ARCH_PADDING=\n)\n\nif %NVMW_CURRENT_TYPE% == iojs (\n  set \"PATH=%NVMW_HOME%;%NVMW_HOME%%NVMW_CURRENT_TYPE%\\%NVMW_CURRENT%%NVMW_CURRENT_ARCH_PADDING%;%PATH_ORG%\"\n  set \"NODE_PATH=%NVMW_HOME%%NVMW_CURRENT_TYPE%\\%NVMW_CURRENT%%NVMW_CURRENT_ARCH_PADDING%\\node_modules\"\n) else (\n  set \"PATH=%NVMW_HOME%;%NVMW_HOME%\\%NVMW_CURRENT%%NVMW_CURRENT_ARCH_PADDING%;%PATH_ORG%\"\n  set \"NODE_PATH=%NVMW_HOME%\\%NVMW_CURRENT%%NVMW_CURRENT_ARCH_PADDING%\\node_modules\"\n)\n\nexit /b 0\n\n::===========================================================\n:: ls : List installed versions\n::===========================================================\n:ls\nsetlocal\n\necho node:\nif exist \"%NVMW_HOME%\" (\n  dir \"%NVMW_HOME%v*\" /b /ad\n)\necho;\necho iojs:\nif exist \"%NVMW_HOME%iojs\" (\n  dir \"%NVMW_HOME%iojs\\*\" /b /ad\n)\necho;\n\nif not defined NVMW_CURRENT (\n  set NVMW_CURRENT_V=none\n) else (\n  set NVMW_CURRENT_V=%NVMW_CURRENT%\n)\necho Current: %NVMW_CURRENT_TYPE%/%NVMW_CURRENT_V% %NVMW_CURRENT_ARCH%\nendlocal\nexit /b 0<br></span></font></pre><p><span style=\"color: rgb(51, 51, 51); font-family: \'Helvetica Neue\', Helvetica, Arial, \'PingFang SC\', \'Hiragino Sans GB\', \'WenQuanYi Micro Hei\', \'Microsoft Yahei\', sans-serif; line-height: 22.4px;\">替换</span><span style=\"color: rgb(51, 51, 51); font-family: \'Helvetica Neue\', Helvetica, Arial, \'PingFang SC\', \'Hiragino Sans GB\', \'WenQuanYi Micro Hei\', \'Microsoft Yahei\', sans-serif; line-height: 22.4px;\">fget.js为：</span></p><pre><font face=\"Helvetica Neue, Helvetica, Arial, PingFang SC, Hiragino Sans GB, WenQuanYi Micro Hei, Microsoft Yahei, sans-serif\"><span style=\"line-height: 22.4px;\">main(WScript.Arguments);\n\n/**\n * Main function\n * @param {Object} args Command line arguments\n */\nfunction main(args) {\n  if (args.length &lt; 2) {\n    log(\'useage: CScript fget.js [url] [filname]\');\n    WScript.Quit(1);\n  }\n\n  var url = args(0)\n    , filename = args(1);\n\n  var completed = false;\n  downloadFile(url, filename, function(err) {\n    if (err) {\n      log(err.message);\n    } else {\n      log(\'Done\');\n    }\n    completed = true;\n  });\n\n  while (!completed) {\n    WScript.Sleep(1000);\n  }\n}\n\n/**\n * Log output to console.\n * @param {String} message\n */\nfunction log(message) {\n  WScript.Echo(message);\n}\n\n/**\n * Download file from specified URL\n *\n * @param {String} url Url to download\n * @param {String} filename Filename to save\n * @param {Function} callback Callback function when download is completed or failed\n */\nfunction downloadFile(url, filename, callback) {\n  var xhr = WScript.createObject(\'Msxml2.ServerXMLHTTP\')\n    , ostream = new ActiveXObject(\"Adodb.Stream\");\n\n  log(\'Download from \' + url + \', and save it as \' + filename);\n\n  xhr.onreadystatechange = function() {\n    if (xhr.readyState === 4) {\n      if (xhr.status === 200) {\n        ostream.type = 1/*adTypeBinary*/;\n        ostream.open();\n        ostream.write(xhr.responseBody);\n        ostream.savetofile(filename, 2/* adSaveCreateOverWrite */);\n        callback();\n      } else {\n        callback(new Error(xhr.status + \' \' + xhr.statusText));\n      }\n      xhr = null;\n      ostream = null;\n    }\n  }\n\n  try {\n    xhr.open(\'GET\', url, true);\n    xhr.send(null);\n  } catch (e) {\n    callback(new Error(\'URL may be invalid\'));\n    xhr.abort();\n  }\n}</span></font><span style=\"color: rgb(51, 51, 51); font-family: \'Helvetica Neue\', Helvetica, Arial, \'PingFang SC\', \'Hiragino Sans GB\', \'WenQuanYi Micro Hei\', \'Microsoft Yahei\', sans-serif; line-height: 22.4px;\">\n</span></pre><div><span style=\"color: rgb(51, 51, 51); font-family: \'Helvetica Neue\', Helvetica, Arial, \'PingFang SC\', \'Hiragino Sans GB\', \'WenQuanYi Micro Hei\', \'Microsoft Yahei\', sans-serif; line-height: 22.4px;\">替换</span><span style=\"color: rgb(51, 51, 51); font-family: \'Helvetica Neue\', Helvetica, Arial, \'PingFang SC\', \'Hiragino Sans GB\', \'WenQuanYi Micro Hei\', \'Microsoft Yahei\', sans-serif; line-height: 22.4px;\">get_npm.js为：</span></div><pre><font face=\"Helvetica Neue, Helvetica, Arial, PingFang SC, Hiragino Sans GB, WenQuanYi Micro Hei, Microsoft Yahei, sans-serif\"><span style=\"line-height: 22.4px;\">var util = require(\'util\'),\n    fs = require(\'fs\'),\n    path = require(\'path\'),\n    wget = require(\'./wget\');\n\nvar NPM_PKG_JSON_URL = \'https://raw.githubusercontent.com/%s/%s/deps/npm/package.json\';\n// https://github.com/npm/npm/tags\nvar NVMW_NPM_MIRROR = process.env.NVMW_NPM_MIRROR || \'https://github.com/npm/npm/archive\';\nvar BASE_URL = NVMW_NPM_MIRROR + \'/v%s.zip\';\n\nvar targetDir = process.argv[2];\nvar versions = process.argv[3].split(\'/\');\nvar binType = versions[0];\nvar binVersion = versions[1];\n\nif (binType === \'iojs\') {\n  // detect npm version from https://iojs.org/dist/index.json\n  var NVMW_IOJS_ORG_MIRROR = process.env.NVMW_IOJS_ORG_MIRROR || \'https://iojs.org/dist\';\n  var pkgUri = \'http://npm.taobao.org/mirrors/node/index.json\'//NVMW_IOJS_ORG_MIRROR + \'/index.json\';\n  wget(pkgUri, function (filename, content) {\n    /*if (filename === null) {\n      return noNpmAndExit();\n    }\n    var npmVersion;\n    var items = JSON.parse(content);\n    for (var i = 0; i &lt; items.length; i++) {\n      var item = items[i];\n      if (!npmVersion) {\n        // make sure has a npm version\n        npmVersion = item.npm;\n      }\n      if (item.version === binVersion &amp;&amp; item.npm) {\n        npmVersion = item.npm;\n        break;\n      }\n    }\n\n    if (!npmVersion) {\n      return noNpmAndExit();\n    }\n    downloadNpmZip(npmVersion);*/\n    if (filename === null) {\n      return noNpmAndExit();\n    }\n    var _pkg = JSON.parse(pkg);\n    for(var i = 0,n=_pkg.length;i&lt;n;i++){\n        var obj = _pkg[i];\n        if(obj.version == binVersion){\n            downloadNpmZip(obj.npm);\n        }\n    }\n  });\n} else {\n  var pkgUri = util.format(NPM_PKG_JSON_URL, \'joyent/node\',\n    binVersion === \'latest\' ? \'master\' : binVersion);\n  wget(pkgUri, function (filename, pkg) {\n    if (filename === null) {\n      return noNpmAndExit();\n    }\n    downloadNpmZip(JSON.parse(pkg).version);\n  });\n}\n\nfunction noNpmAndExit() {\n  console.error(\'%s %s does not include npm\', binType, binVersion);\n  process.exit(1);\n}\n\nfunction downloadNpmZip(version) {\n  var uri = util.format(BASE_URL, version);\n  wget(uri, function (filename, data) {\n    if (filename === null) {\n        console.error(\'Can\\\'t get npm: \' + uri);\n        process.exit(1);\n    }\n    fs.writeFile(path.join(targetDir, \'npm.zip\'), data, function (err) {\n      if (err) {\n        return console.error(err.message);\n      }\n      console.log(\'Download npm %s is done\', version);\n    });\n  });\n}</span></font><span style=\"color: rgb(51, 51, 51); font-family: \'Helvetica Neue\', Helvetica, Arial, \'PingFang SC\', \'Hiragino Sans GB\', \'WenQuanYi Micro Hei\', \'Microsoft Yahei\', sans-serif; line-height: 22.4px;\">\n</span></pre><div><span style=\"color: rgb(51, 51, 51); font-family: \'Helvetica Neue\', Helvetica, Arial, \'PingFang SC\', \'Hiragino Sans GB\', \'WenQuanYi Micro Hei\', \'Microsoft Yahei\', sans-serif; line-height: 22.4px;\">由于特殊国情，需要使用淘宝镜像</span></div><pre><pre class=\"hljs cs\" style=\"font-family: \'Source Code Pro\', Consolas, Menlo, Monaco, \'Courier New\', monospace; font-size: 0.93em; padding: 1em; margin-bottom: 1.5em; line-height: 1.3; color: rgb(101, 123, 131); border: none; border-radius: 3px; max-height: 35em; position: relative;\"><code style=\"font-family: \'Source Code Pro\', Consolas, Menlo, Monaco, \'Courier New\', monospace; font-size: 1em; white-space: inherit; overflow-wrap: normal; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;\"><span class=\"hljs-keyword\" style=\"color: rgb(133, 153, 0);\">set</span> <span class=\"hljs-string\" style=\"color: rgb(42, 161, 152);\">\"NVMW_NODEJS_ORG_MIRROR=http://npm.taobao.org/mirrors/node\"</span>\n<span class=\"hljs-keyword\" style=\"color: rgb(133, 153, 0);\">set</span> <span class=\"hljs-string\" style=\"color: rgb(42, 161, 152);\">\"NVMW_IOJS_ORG_MIRROR=http://npm.taobao.org/mirrors/iojs\"</span>\n<span class=\"hljs-keyword\" style=\"color: rgb(133, 153, 0);\">set</span> <span class=\"hljs-string\" style=\"color: rgb(42, 161, 152);\">\"NVMW_NPM_MIRROR=http://npm.taobao.org/mirrors/npm\"</span></code></pre></pre><p><span style=\"color: rgb(51, 51, 51); font-family: \'Helvetica Neue\', Helvetica, Arial, \'PingFang SC\', \'Hiragino Sans GB\', \'WenQuanYi Micro Hei\', \'Microsoft Yahei\', sans-serif; line-height: 22.4px;\">注：每次使用，都得重新在命令行中设置，或者可以这三个变量也设置到环境变量中，或改一下他的源码，把这三个变量写死。</span></p><p><span style=\"color: rgb(51, 51, 51); font-family: \'Helvetica Neue\', Helvetica, Arial, \'PingFang SC\', \'Hiragino Sans GB\', \'WenQuanYi Micro Hei\', \'Microsoft Yahei\', sans-serif; line-height: 22.4px;\">按照命令安装node:</span></p><pre><pre class=\"hljs sql\" style=\"font-family: \'Source Code Pro\', Consolas, Menlo, Monaco, \'Courier New\', monospace; font-size: 0.93em; padding: 1em; margin-bottom: 1.5em; line-height: 1.3; color: rgb(101, 123, 131); border: none; border-radius: 3px; max-height: 35em; position: relative;\"><code style=\"font-family: \'Source Code Pro\', Consolas, Menlo, Monaco, \'Courier New\', monospace; font-size: 1em; white-space: inherit; overflow-wrap: normal; background-image: none; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;\">nvmw <span class=\"hljs-operator\"><span class=\"hljs-keyword\" style=\"color: rgb(133, 153, 0);\">install</span> <span class=\"hljs-number\" style=\"color: rgb(42, 161, 152);\">5.9</span><span class=\"hljs-number\" style=\"color: rgb(42, 161, 152);\">.1</span></span></code></pre></pre><p><span style=\"color: rgb(51, 51, 51); font-family: \'Helvetica Neue\', Helvetica, Arial, \'PingFang SC\', \'Hiragino Sans GB\', \'WenQuanYi Micro Hei\', \'Microsoft Yahei\', sans-serif; line-height: 22.4px;\">如果提示</span><span style=\"color: inherit; font-family: Menlo, Monaco, Consolas, \'Courier New\', monospace; font-size: inherit; white-space: pre-wrap; line-height: 22px; background-color: transparent;\">does </span><span class=\"hljs-keyword\" style=\"color: inherit; font-family: Menlo, Monaco, Consolas, \'Courier New\', monospace; font-size: inherit; white-space: pre-wrap; line-height: 22px; word-wrap: break-word; word-break: break-all; background-color: transparent;\">not</span><span style=\"color: inherit; font-family: Menlo, Monaco, Consolas, \'Courier New\', monospace; font-size: inherit; white-space: pre-wrap; line-height: 22px; background-color: transparent;\"> </span><span class=\"hljs-keyword\" style=\"color: inherit; font-family: Menlo, Monaco, Consolas, \'Courier New\', monospace; font-size: inherit; white-space: pre-wrap; line-height: 22px; word-wrap: break-word; word-break: break-all; background-color: transparent;\">include</span><span style=\"color: inherit; font-family: Menlo, Monaco, Consolas, \'Courier New\', monospace; font-size: inherit; white-space: pre-wrap; line-height: 22px; background-color: transparent;\"> npm，需要手动下载</span><span style=\"color: rgb(51, 51, 51); font-family: monospace; font-size: 13px; line-height: 25px;\"><a href=\"https://github.com/npm/npm\">npm-master.zip</a>, 并改名为npm.zip后放到nvmw目录下的v5.9.1文件下，并重新执行安装命令。即可安装成功。</span></p><p><span style=\"color: rgb(51, 51, 51); font-family: \'Helvetica Neue\', Helvetica, Arial, \'PingFang SC\', \'Hiragino Sans GB\', \'WenQuanYi Micro Hei\', \'Microsoft Yahei\', sans-serif; line-height: 22.4px;\"><br></span></p><p><span style=\"color: rgb(51, 51, 51); font-family: \'Helvetica Neue\', Helvetica, Arial, \'PingFang SC\', \'Hiragino Sans GB\', \'WenQuanYi Micro Hei\', \'Microsoft Yahei\', sans-serif; line-height: 22.4px;\"><br></span></p><p><br></p>', '0', '2016', '11', '30', '2016-11-30 15:54:12', '0');
INSERT INTO `blog` VALUES ('test', 'test', 'sdaf', '0', '2016', '9', '30', '2016-09-22 15:55:13', '0');
INSERT INTO `blog` VALUES ('yeoman', 'windows下yeoman脚手架搭建', '<h2>windows下yeoman脚手架搭建</h2><p>1 &nbsp;确保你已配置好node和npm环境</p><p>&nbsp; &nbsp; 在命令行窗口输入node -v 以及npm -v, 查看node和npm版本</p><p>2 &nbsp;安装yeoman</p><pre>npm install -g yo grunt-cli bower</pre><p>&nbsp; &nbsp; 通过一下命令来检查是否已经安装成功</p><pre>yo --version &amp;&amp; bower --version &amp;&amp; grunt --version</pre><p>3 &nbsp;去<a href=\"http://yeoman.io/generators/\">yeoman官网</a>搜索需要用到的脚手架</p><p><img src=\"http://127.0.0.1:8080/ssm/rest/img/yeoman.png\" style=\"width: 690px;\"><br></p><p>点进你需要的脚手架，会有安装命令</p><p><img src=\"http://127.0.0.1:8080/ssm/rest/img/webpack_install.png\" style=\"width: 413px;\"><br></p><p>如果已经安装yo,只需要运行这个命令即可</p><pre>npm install -g generator-react-webpack</pre><p>4 &nbsp;在工作目录下新建项目文件夹， 在命令行窗口cd到这个文件夹里，输入</p><pre>yo react-webpack</pre><p>或者直接输入yo, 在下面的yo选择中选择react-webpack，之后就会进入创建文件的相关选择。</p><p>5 如果提示这样的错误，需要按照图中的做法一个一个install上</p><p><img src=\"http://127.0.0.1:8080/ssm/rest/img/yo_solve.png\" style=\"width: 640px;\"><br></p><p>有些时候npm不太好用，<a href=\"https://npm.taobao.org/\">这里推荐一下淘宝的镜像网站以及cnpm</a>，npm不好用时就还cnpm。</p><p>6 &nbsp;成功之后是这样的</p><p><img src=\"http://127.0.0.1:8080/ssm/rest/img/success.png\" style=\"width: 669px;\"><br></p><p><br></p>', '0', '2016', '12', '1', '2016-12-01 11:18:00', '0');

-- ----------------------------
-- Table structure for `permission`
-- ----------------------------
DROP TABLE IF EXISTS `permission`;
CREATE TABLE `permission` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '权限id',
  `permission_name` varchar(32) DEFAULT NULL COMMENT '权限名',
  `permission_sign` varchar(128) DEFAULT NULL COMMENT '权限标识,程序中判断使用,如"user:create"',
  `description` varchar(256) DEFAULT NULL COMMENT '权限描述,UI界面显示使用',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 CHECKSUM=1 DELAY_KEY_WRITE=1 ROW_FORMAT=DYNAMIC COMMENT='权限表';

-- ----------------------------
-- Records of permission
-- ----------------------------
INSERT INTO `permission` VALUES ('1', '用户新增', 'user:create', null);

-- ----------------------------
-- Table structure for `role`
-- ----------------------------
DROP TABLE IF EXISTS `role`;
CREATE TABLE `role` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '角色id',
  `role_name` varchar(32) DEFAULT NULL COMMENT '角色名',
  `role_sign` varchar(128) DEFAULT NULL COMMENT '角色标识,程序中判断使用,如"admin"',
  `description` varchar(256) DEFAULT NULL COMMENT '角色描述,UI界面显示使用',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 CHECKSUM=1 DELAY_KEY_WRITE=1 ROW_FORMAT=DYNAMIC COMMENT='角色表';

-- ----------------------------
-- Records of role
-- ----------------------------
INSERT INTO `role` VALUES ('1', 'admin', 'admin', '管理员');

-- ----------------------------
-- Table structure for `role_permission`
-- ----------------------------
DROP TABLE IF EXISTS `role_permission`;
CREATE TABLE `role_permission` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '表id',
  `role_id` bigint(20) unsigned DEFAULT NULL COMMENT '角色id',
  `permission_id` bigint(20) unsigned DEFAULT NULL COMMENT '权限id',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 CHECKSUM=1 DELAY_KEY_WRITE=1 ROW_FORMAT=DYNAMIC COMMENT='角色与权限关联表';

-- ----------------------------
-- Records of role_permission
-- ----------------------------
INSERT INTO `role_permission` VALUES ('1', '2', '1');

-- ----------------------------
-- Table structure for `user`
-- ----------------------------
DROP TABLE IF EXISTS `user`;
CREATE TABLE `user` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '用户id',
  `username` varchar(50) DEFAULT NULL COMMENT '用户名',
  `password` char(64) DEFAULT NULL COMMENT '密码',
  `state` varchar(32) DEFAULT NULL COMMENT '状态',
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 CHECKSUM=1 DELAY_KEY_WRITE=1 ROW_FORMAT=DYNAMIC COMMENT='用户表';

-- ----------------------------
-- Records of user
-- ----------------------------
INSERT INTO `user` VALUES ('1', 'xiass', 'smay1227', null, '2016-09-20 17:32:08');

-- ----------------------------
-- Table structure for `user_role`
-- ----------------------------
DROP TABLE IF EXISTS `user_role`;
CREATE TABLE `user_role` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '表id',
  `user_id` bigint(20) unsigned DEFAULT NULL COMMENT '用户id',
  `role_id` bigint(20) unsigned DEFAULT NULL COMMENT '角色id',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 CHECKSUM=1 DELAY_KEY_WRITE=1 ROW_FORMAT=DYNAMIC COMMENT='用户与角色关联表';

-- ----------------------------
-- Records of user_role
-- ----------------------------
INSERT INTO `user_role` VALUES ('1', '1', '1');
