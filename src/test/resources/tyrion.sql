/*
Navicat MySQL Data Transfer

Source Server         : local
Source Server Version : 50715
Source Host           : localhost:3306
Source Database       : tyrion

Target Server Type    : MYSQL
Target Server Version : 50715
File Encoding         : 65001

Date: 2016-11-16 15:09:38
*/

SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for `blog`
-- ----------------------------
DROP TABLE IF EXISTS `blog`;
CREATE TABLE `blog` (
  `urlname` varchar(255) NOT NULL,
  `title` varchar(255) NOT NULL,
  `content` longtext NOT NULL,
  `type` varchar(2) NOT NULL COMMENT '0  java;\r\n1  android;\r\n2  php;\r\n3  随笔；',
  `year` varchar(4) NOT NULL,
  `month` varchar(2) NOT NULL,
  `day` varchar(2) NOT NULL,
  `date` datetime NOT NULL,
  `status` varchar(2) DEFAULT NULL COMMENT '0 正常； 1 删除',
  PRIMARY KEY (`urlname`,`year`,`month`,`day`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of blog
-- ----------------------------
INSERT INTO `blog` VALUES ('app_auto_start', '安卓开机自动启动app', '<p>1 新建一个类继承BroadcastReceiver, 监听系统的BOOT_COMPLETED</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#cc7832;\">package </span>com.zteits.parkingpay.receiver<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">import </span>android.content.BroadcastReceiver<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">import </span>android.content.Context<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">import </span>android.content.Intent<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">import </span>com.zteits.parkingpay.MainActivity<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#629755;font-style:italic;\">/**<br></span><span style=\"color:#629755;font-style:italic;\"> * Created by xiashuai on 10:24 2016/10/25.<br></span><span style=\"color:#629755;font-style:italic;\"> * Connection smay1227@163.com.<br></span><span style=\"color:#629755;font-style:italic;\"> */<br></span><span style=\"color:#629755;font-style:italic;\"><br></span><span style=\"color:#cc7832;\">public class </span>BootBroadcastReceiver <span style=\"color:#cc7832;\">extends </span>BroadcastReceiver {<br><br>   <span style=\"color:#cc7832;\">static final </span>String <span style=\"color:#9876aa;font-style:italic;\">ACTION </span>= <span style=\"color:#6a8759;\">\"android.intent.action.BOOT_COMPLETED\"</span><span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">   </span><span style=\"color:#bbb529;\">@Override<br></span><span style=\"color:#bbb529;\">   </span><span style=\"color:#cc7832;\">public void </span><span style=\"color:#ffc66d;\">onReceive</span>(Context context<span style=\"color:#cc7832;\">, </span>Intent intent) {<br>      <span style=\"color:#cc7832;\">if </span>(intent.getAction().equals(<span style=\"color:#9876aa;font-style:italic;\">ACTION</span>)){<br>         Intent mainActivityIntent = <span style=\"color:#cc7832;\">new </span>Intent(context<span style=\"color:#cc7832;\">, </span>MainActivity.<span style=\"color:#cc7832;\">class</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">         </span>mainActivityIntent.addFlags(Intent.<span style=\"color:#9876aa;font-style:italic;\">FLAG_ACTIVITY_NEW_TASK</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">         </span>context.startActivity(mainActivityIntent)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>}<br>   }<br>}<br></pre></pre><p>2 在配置文件中添加权限</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#e8bf6a;\">&lt;uses-permission </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.permission.RECEIVE_BOOT_COMPLETED\"</span><span style=\"color:#e8bf6a;\">/&gt;</span></pre></pre><p>3 在配置文件中注册receiver</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#e8bf6a;\">&lt;receiver </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\".receiver.BootBroadcastReceiver\"</span><span style=\"color:#e8bf6a;\">&gt;<br></span><span style=\"color:#e8bf6a;\">    &lt;intent-filter&gt;<br></span><span style=\"color:#e8bf6a;\">        &lt;action </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.intent.action.BOOT_COMPLETED\"</span><span style=\"color:#e8bf6a;\">/&gt;<br></span><span style=\"color:#e8bf6a;\">    &lt;/intent-filter&gt;<br></span><span style=\"color:#e8bf6a;\">&lt;/receiver&gt;</span></pre></pre><p>经过以上步骤就可以了</p><p><br></p>', '0', '2016', '10', '28', '2016-10-28 10:32:19', '0');
INSERT INTO `blog` VALUES ('blog', 'my blog', '<p>this is my blog.</p>', '0', '2016', '9', '30', '2016-09-30 16:00:44', '0');
INSERT INTO `blog` VALUES ('mifarecontrol', 'NFC Mifare卡读写封装类', '<h2>NFC Mifare卡读写封装类</h2><p>专门创建了MifareControl类实现了对Mifare卡读写的封装操作。此类是根据我们公司现有的业务逻辑改的，不过读写操作是通用的。</p><p>MifareControl里面主要实现了以下功能：</p><ul><li>判断卡里扇区的密码是否被修改</li><li>读取卡片的出场信息</li><li>制卡</li><li>读取车主卡号</li><li>修改扇区的默认密钥</li><li>读取和修改卡内余额</li></ul><p>首先应该拿到感应到的tag，来初始化MifareClassic</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#cc7832;\">public </span><span style=\"color:#ffc66d;\">MifareControl</span>(Tag tag){<br>   <span style=\"color:#cc7832;\">try </span>{<br>      <span style=\"color:#9876aa;\">mfc </span>= MifareClassic.<span style=\"font-style:italic;\">get</span>(tag)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span><span style=\"color:#9876aa;\">mfc</span>.connect()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>} <span style=\"color:#cc7832;\">catch </span>(IOException e) {<br>      e.printStackTrace()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br>}</pre></pre><p>当操作完成之后关闭连接</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#cc7832;\">public void </span><span style=\"color:#ffc66d;\">close</span>() <span style=\"color:#cc7832;\">throws </span>Exception{<br>   <span style=\"color:#cc7832;\">if </span>(<span style=\"color:#9876aa;\">mfc </span>!= <span style=\"color:#cc7832;\">null</span>) {<br>      <span style=\"color:#9876aa;\">mfc</span>.close()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br>}</pre></pre><h3>制卡</h3><p>修改第一扇区第二块写入车主卡号，注意要16个字节</p><p>修改第一扇区第三块写入卡片类型，卡内金额和日期，加起来要16字节，金额给了四个字节，这里做了移位操作。</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#cc7832;\">public void </span><span style=\"color:#ffc66d;\">makeCarCard</span>(IcCard icCard) <span style=\"color:#cc7832;\">throws </span>Exception{<br>   <span style=\"color:#cc7832;\">if </span>(<span style=\"color:#9876aa;\">mfc</span>.authenticateSectorWithKeyA(<span style=\"color:#9876aa;font-style:italic;\">SECTOR_ADDRESS</span><span style=\"color:#cc7832;\">, </span>MifareClassic.<span style=\"color:#9876aa;font-style:italic;\">KEY_DEFAULT</span>)){<br>      <span style=\"color:#808080;\">//</span><span style=\"color:#808080;font-family:\'宋体\';\">写入卡号<br></span><span style=\"color:#808080;font-family:\'宋体\';\">      </span><span style=\"color:#cc7832;\">byte</span>[] carNo = icCard.<span style=\"color:#9876aa;\">card_no</span>.getBytes()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span><span style=\"color:#9876aa;\">mfc</span>.writeBlock(<span style=\"color:#9876aa;font-style:italic;\">BLOCK_ONE</span><span style=\"color:#cc7832;\">, </span>carNo)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span><span style=\"color:#808080;\">//</span><span style=\"color:#808080;font-family:\'宋体\';\">写入卡的类型，金额和日期<br></span><span style=\"color:#808080;font-family:\'宋体\';\"><br></span><span style=\"color:#808080;font-family:\'宋体\';\">      </span><span style=\"color:#cc7832;\">byte</span>[] data = <span style=\"color:#9876aa;\">mfc</span>.readBlock(<span style=\"color:#9876aa;font-style:italic;\">BLOCK_TWO</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"MAKE_CARD\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"data length: \" </span>+ data.<span style=\"color:#9876aa;\">length</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"MAKE_CARD\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"data string: \" </span>+ <span style=\"color:#cc7832;\">new </span>String(data))<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">      byte</span>[] type = icCard.<span style=\"color:#9876aa;\">type</span>.getBytes()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>System.<span style=\"font-style:italic;\">arraycopy</span>(type<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">0</span><span style=\"color:#cc7832;\">, </span>data<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">0</span><span style=\"color:#cc7832;\">, </span>type.<span style=\"color:#9876aa;\">length</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">      byte</span>[] count = Converter.<span style=\"font-style:italic;\">intToByteArray</span>(Integer.<span style=\"font-style:italic;\">parseInt</span>(icCard.<span style=\"color:#9876aa;\">card_remain</span>))<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>System.<span style=\"font-style:italic;\">arraycopy</span>(count<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">0</span><span style=\"color:#cc7832;\">, </span>data<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">2</span><span style=\"color:#cc7832;\">, </span>count.<span style=\"color:#9876aa;\">length</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">      byte</span>[] date = icCard.<span style=\"color:#9876aa;\">card_date</span>.getBytes()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>System.<span style=\"font-style:italic;\">arraycopy</span>(date<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">0</span><span style=\"color:#cc7832;\">, </span>data<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">6</span><span style=\"color:#cc7832;\">, </span>date.<span style=\"color:#9876aa;\">length</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">      </span>Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"MAKE_CARD\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"data length: \" </span>+ data.<span style=\"color:#9876aa;\">length</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"MAKE_CARD\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"data string: \" </span>+ <span style=\"color:#cc7832;\">new </span>String(data))<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span><span style=\"color:#9876aa;\">mfc</span>.writeBlock(<span style=\"color:#9876aa;font-style:italic;\">BLOCK_TWO</span><span style=\"color:#cc7832;\">, </span>data)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span><span style=\"color:#808080;\">//</span><span style=\"color:#808080;font-family:\'宋体\';\">修改密码<br></span><span style=\"color:#808080;font-family:\'宋体\';\">      </span>changePwd()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<span style=\"color:#cc7832;\">else </span>{<br>      <span style=\"color:#cc7832;\">throw new </span>AppException(<span style=\"color:#6a8759;\">\"</span><span style=\"color:#6a8759;font-family:\'宋体\';\">制卡失败</span><span style=\"color:#6a8759;\">!\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br>}</pre></pre><p>修改默认扇区的密码</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#cc7832;\">private void </span><span style=\"color:#ffc66d;\">changePwd</span>() <span style=\"color:#cc7832;\">throws </span>Exception{<br>   <span style=\"color:#cc7832;\">if </span>(<span style=\"color:#9876aa;\">mfc</span>.authenticateSectorWithKeyA(<span style=\"color:#9876aa;font-style:italic;\">SECTOR_ADDRESS</span><span style=\"color:#cc7832;\">, </span>MifareClassic.<span style=\"color:#9876aa;font-style:italic;\">KEY_DEFAULT</span>)){<br>      <span style=\"color:#cc7832;\">byte</span>[] data = <span style=\"color:#9876aa;\">mfc</span>.readBlock(<span style=\"color:#9876aa;font-style:italic;\">BLOCK_THREE</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      byte</span>[] keyByte = Converter.<span style=\"font-style:italic;\">hexStringToBytes</span>(<span style=\"color:#9876aa;font-style:italic;\">key</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>System.<span style=\"font-style:italic;\">arraycopy</span>(keyByte<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">0</span><span style=\"color:#cc7832;\">, </span>data<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">0</span><span style=\"color:#cc7832;\">, </span>keyByte.<span style=\"color:#9876aa;\">length</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span><span style=\"color:#9876aa;\">mfc</span>.writeBlock(<span style=\"color:#9876aa;font-style:italic;\">BLOCK_THREE</span><span style=\"color:#cc7832;\">, </span>data)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<span style=\"color:#cc7832;\">else </span>{<br>      <span style=\"color:#cc7832;\">throw new </span>AppException(<span style=\"color:#6a8759;\">\"</span><span style=\"color:#6a8759;font-family:\'宋体\';\">更改默认秘钥失败</span><span style=\"color:#6a8759;\">!\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br>}</pre></pre><h3>读取和修改卡内余额</h3><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#cc7832;\">public </span>String <span style=\"color:#ffc66d;\">readRemainCount</span>(String cardNo) <span style=\"color:#cc7832;\">throws </span>Exception{<br>   String count<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   if </span>(!isTheSame(cardNo)){<br>      <span style=\"color:#cc7832;\">throw new </span>AppException(<span style=\"color:#6a8759;\">\"</span><span style=\"color:#6a8759;font-family:\'宋体\';\">传入的卡号与当前读取的卡号不匹配</span><span style=\"color:#6a8759;\">!\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br>   <span style=\"color:#cc7832;\">if </span>(<span style=\"color:#9876aa;\">mfc</span>.authenticateSectorWithKeyA(<span style=\"color:#9876aa;font-style:italic;\">SECTOR_ADDRESS</span><span style=\"color:#cc7832;\">, </span>Converter.<span style=\"font-style:italic;\">hexStringToBytes</span>(<span style=\"color:#9876aa;font-style:italic;\">key</span>))){<br>      <span style=\"color:#cc7832;\">byte</span>[] data = <span style=\"color:#9876aa;\">mfc</span>.readBlock(<span style=\"color:#9876aa;font-style:italic;\">BLOCK_TWO</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      byte</span>[] card_remain = <span style=\"color:#cc7832;\">new byte</span>[<span style=\"color:#6897bb;\">4</span>]<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>System.<span style=\"font-style:italic;\">arraycopy</span>(data<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">2</span><span style=\"color:#cc7832;\">, </span>card_remain<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">0</span><span style=\"color:#cc7832;\">, </span>card_remain.<span style=\"color:#9876aa;\">length</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>count = String.<span style=\"font-style:italic;\">valueOf</span>(Converter.<span style=\"font-style:italic;\">byteArrayToInt</span>(card_remain))<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<span style=\"color:#cc7832;\">else </span>{<br>      <span style=\"color:#cc7832;\">throw new </span>AppException(<span style=\"color:#6a8759;\">\"</span><span style=\"color:#6a8759;font-family:\'宋体\';\">读取余额失败</span><span style=\"color:#6a8759;\">!\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br>   <span style=\"color:#cc7832;\">return </span>count<span style=\"color:#cc7832;\">;<br></span>}</pre></pre><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#cc7832;\">public void </span><span style=\"color:#ffc66d;\">updateRemainCount</span>(String cardNo<span style=\"color:#cc7832;\">, </span>String remain_count) <span style=\"color:#cc7832;\">throws </span>Exception{<br>   <span style=\"color:#cc7832;\">if </span>(!isTheSame(cardNo)){<br>      <span style=\"color:#cc7832;\">throw new </span>AppException(<span style=\"color:#6a8759;\">\"</span><span style=\"color:#6a8759;font-family:\'宋体\';\">传入的卡号与当前读取的卡号不匹配</span><span style=\"color:#6a8759;\">!\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br>   <span style=\"color:#cc7832;\">if </span>(<span style=\"color:#9876aa;\">mfc</span>.authenticateSectorWithKeyA(<span style=\"color:#9876aa;font-style:italic;\">SECTOR_ADDRESS</span><span style=\"color:#cc7832;\">, </span>Converter.<span style=\"font-style:italic;\">hexStringToBytes</span>(<span style=\"color:#9876aa;font-style:italic;\">key</span>))){<br>      <span style=\"color:#cc7832;\">byte</span>[] data = <span style=\"color:#9876aa;\">mfc</span>.readBlock(<span style=\"color:#9876aa;font-style:italic;\">BLOCK_TWO</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      byte</span>[] price = Converter.<span style=\"font-style:italic;\">intToByteArray</span>(Integer.<span style=\"font-style:italic;\">parseInt</span>(remain_count))<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>System.<span style=\"font-style:italic;\">arraycopy</span>(price<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">0</span><span style=\"color:#cc7832;\">, </span>data<span style=\"color:#cc7832;\">, </span><span style=\"color:#6897bb;\">2</span><span style=\"color:#cc7832;\">, </span>price.<span style=\"color:#9876aa;\">length</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span><span style=\"color:#9876aa;\">mfc</span>.writeBlock(<span style=\"color:#9876aa;font-style:italic;\">BLOCK_TWO</span><span style=\"color:#cc7832;\">, </span>data)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<span style=\"color:#cc7832;\">else </span>{<br>      <span style=\"color:#cc7832;\">throw new </span>AppException(<span style=\"color:#6a8759;\">\"</span><span style=\"color:#6a8759;font-family:\'宋体\';\">读取余额失败</span><span style=\"color:#6a8759;\">!\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br><br>}</pre></pre><p>主要就是读写操作，详细的信息可以看demo。</p><p><br></p>', '0', '2016', '11', '16', '2016-11-16 14:54:07', '0');
INSERT INTO `blog` VALUES ('nfc_demo', 'android nfc demo', '<p></p><h2>android nfc demo</h2>\n<p>我这边只有mifare卡，这个demo也是针对m1卡编写的</p>\n<p>当android扫描到NFC标签时，会自动寻找最适合的Activity来处理这个TAG，如果有多个Activity满足条件的话，会让用户来选择到底使用哪一个Activity来处理\n但我们的业务逻辑会有好多activity要对卡里的内容进行操作，如果让用户自己选择的话会有点不友好。</p>\n<p>我的处理是把我们业务上所有对卡的处理，全都放到一个activity里，setResult来把处理结果以及查询信息返回到调用activity那里。处理NFC的activity做成dialog\n样式的，提醒将卡片靠近。</p>\n<p>M1卡有16个扇区，64块，每个扇区有4块，第一扇区第1块，只能执行读操作，不能进行写操作。每个扇区都是独立的，每个扇区的第四块是存放各个扇区密码的地方。\n我们能进行操作的是第一扇区的第2，3块，以及其他扇区的第1，2，3块。</p>\n<p>这个demo主要改的信息为：</p>\n\n   <ul>\n      <li>获取卡片的默认出场信息</li>\n      <li>修改第一扇区的默认密码</li>\n      <li>第一扇区第2块写入自己定义的卡号</li>\n      <li>第一扇区第3块写入卡片类型，金额，日期</li>\n      <li>修改金额，充值或者刷卡</li>\n   </ul>\n<a href=\"https://github.com/smay1227/NFCDEMO\" target=\"_blank\">demo地址</a><p></p><p><br>\n\n</p>', '0', '2016', '11', '16', '2016-11-16 11:12:11', '0');
INSERT INTO `blog` VALUES ('nfc_settings', 'NFC Android机器操作Mifare卡具体配置', '<h2>android 实现NFC功能具体配置</h2><h3>android manifest配置</h3><p>首先声明nfc使用权限</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#e8bf6a;\">&lt;uses-permission </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.permission.NFC\"</span><span style=\"color:#e8bf6a;\">/&gt;</span></pre></pre><p>硬件功能：表明应用需要用的硬件功能</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#e8bf6a;\">&lt;uses-feature<br></span><span style=\"color:#e8bf6a;\">    </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.hardware.nfc\"<br></span><span style=\"color:#6a8759;\">    </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:required=</span><span style=\"color:#6a8759;\">\"true\"</span><span style=\"color:#e8bf6a;\">/&gt;</span></pre></pre><p>创建一个activity用来处理机器扫描到nfc的信息，并在activity的intent-filter里声明要处理的标签类型，activity的launchMode设为singleTop，demo里面为了用户友好，把activity的样式设为了dialog类型。</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#e8bf6a;\">&lt;activity<br></span><span style=\"color:#e8bf6a;\">    </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\".activity.LogicActivity\"<br></span><span style=\"color:#6a8759;\">    </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:launchMode=</span><span style=\"color:#6a8759;\">\"singleTop\"<br></span><span style=\"color:#6a8759;\">    </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:screenOrientation=</span><span style=\"color:#6a8759;\">\"portrait\"<br></span><span style=\"color:#6a8759;\">    </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:theme=</span><span style=\"color:#6a8759;\">\"@style/DialogStyle\"</span><span style=\"color:#e8bf6a;\">&gt;<br></span><span style=\"color:#e8bf6a;\">    &lt;intent-filter&gt;<br></span><span style=\"color:#e8bf6a;\">        &lt;action </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.nfc.action.NDEF_DISCOVERED\"</span><span style=\"color:#e8bf6a;\">/&gt;<br></span><span style=\"color:#e8bf6a;\">        &lt;data </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:mimeType=</span><span style=\"color:#6a8759;\">\"text/plain\"</span><span style=\"color:#e8bf6a;\">/&gt;<br></span><span style=\"color:#e8bf6a;\">    &lt;/intent-filter&gt;<br></span><span style=\"color:#e8bf6a;\"><br></span><span style=\"color:#e8bf6a;\">    &lt;intent-filter&gt;<br></span><span style=\"color:#e8bf6a;\">        &lt;action </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.nfc.action.TAG_DISCOVERED\"</span><span style=\"color:#e8bf6a;\">&gt;<br></span><span style=\"color:#e8bf6a;\">        &lt;/action&gt;<br></span><span style=\"color:#e8bf6a;\">        &lt;category </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.intent.category.DEFAULT\"</span><span style=\"color:#e8bf6a;\">&gt;<br></span><span style=\"color:#e8bf6a;\">        &lt;/category&gt;<br></span><span style=\"color:#e8bf6a;\">    &lt;/intent-filter&gt;<br></span><span style=\"color:#e8bf6a;\"><br></span><span style=\"color:#e8bf6a;\">    &lt;intent-filter&gt;<br></span><span style=\"color:#e8bf6a;\">        &lt;action </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.nfc.action.TECH_DISCOVERED\"</span><span style=\"color:#e8bf6a;\">/&gt;<br></span><span style=\"color:#e8bf6a;\">    &lt;/intent-filter&gt;<br></span><span style=\"color:#e8bf6a;\"><br></span><span style=\"color:#e8bf6a;\">    &lt;meta-data<br></span><span style=\"color:#e8bf6a;\">        </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:name=</span><span style=\"color:#6a8759;\">\"android.nfc.action.TECH_DISCOVERED\"<br></span><span style=\"color:#6a8759;\">        </span><span style=\"color:#9876aa;\">android</span><span style=\"color:#bababa;\">:resource=</span><span style=\"color:#6a8759;\">\"@xml/nfc_tech_filter\"</span><span style=\"color:#e8bf6a;\">/&gt;<br></span><span style=\"color:#e8bf6a;\"><br></span><span style=\"color:#e8bf6a;\">&lt;/activity&gt;</span></pre></pre><p>创建meta-data里nfc_tech_filter里的内容</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#e8bf6a;\">&lt;?</span><span style=\"color:#bababa;\">xml version=</span><span style=\"color:#6a8759;\">\"1.0\" </span><span style=\"color:#bababa;\">encoding=</span><span style=\"color:#6a8759;\">\"utf-8\"</span><span style=\"color:#e8bf6a;\">?&gt;<br></span><span style=\"color:#e8bf6a;\">&lt;resources </span><span style=\"color:#bababa;\">xmlns:</span><span style=\"color:#9876aa;\">xliff</span><span style=\"color:#bababa;\">=</span><span style=\"color:#6a8759;\">\"urn:oasis:names:tc:xliff:document:1.2\"</span><span style=\"color:#e8bf6a;\">&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.IsoDep<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.NfcA<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.NfcB<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.NfcF<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.NfcV<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.Ndef<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.NdefFormatable<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.MifareClassic<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">   &lt;tech&gt;</span>android.nfc.tech.MifareUltralight<span style=\"color:#e8bf6a;\">&lt;/tech&gt;<br></span><span style=\"color:#e8bf6a;\">&lt;/resources&gt;</span></pre></pre><h3>LogicActivity 逻辑处理</h3><p>系统扫描到NFC标签时都会调用LogicActivity，并在onNewIntent里对NFC tag里的信息进行处理。</p><p>这边是判断了LogicActivity的启动来源，不同来源对应不同的处理事件，当次activity不是人为启动而是系统扫描到nfc标签时自动打开的时候，此activity会自己关闭掉。</p><p>最后通过返回码，返回到调用者activity。</p><p>具体的处理逻辑如下：</p><pre><pre style=\"background-color:#2b2b2b;color:#a9b7c6;font-family:\'Consolas\';font-size:13.5pt;\"><span style=\"color:#cc7832;\">private void </span><span style=\"color:#ffc66d;\">processIntent</span>(Intent intent){<br>   <span style=\"color:#cc7832;\">if </span>(<span style=\"color:#9876aa;\">mFrom </span>== -<span style=\"color:#6897bb;\">1</span>){<br>      finish()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      return;<br></span><span style=\"color:#cc7832;\">   </span>}<br>   <span style=\"color:#cc7832;\">if </span>(<span style=\"color:#9876aa;\">mIntent </span>== <span style=\"color:#cc7832;\">null</span>){<br>      <span style=\"color:#cc7832;\">return;<br></span><span style=\"color:#cc7832;\">   </span>}<br>   <span style=\"color:#808080;\">//</span><span style=\"color:#808080;font-family:\'宋体\';\">取出封装在</span><span style=\"color:#808080;\">intent</span><span style=\"color:#808080;font-family:\'宋体\';\">中的</span><span style=\"color:#808080;\">TAG<br></span><span style=\"color:#808080;\">   </span>Tag tagFromIntent = intent.getParcelableExtra(NfcAdapter.<span style=\"color:#9876aa;font-style:italic;\">EXTRA_TAG</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   for </span>(String tech : tagFromIntent.getTechList()) {<br>      System.<span style=\"color:#9876aa;font-style:italic;\">out</span>.println(tech)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br><br>   MifareControl mc = <span style=\"color:#cc7832;\">new </span>MifareControl(tagFromIntent)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">   try </span>{<br>      Intent intentResult = <span style=\"color:#cc7832;\">new </span>Intent()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      switch </span>(<span style=\"color:#9876aa;\">mFrom</span>){<br>         <span style=\"color:#cc7832;\">case </span>CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_CHARGE</span>:<br>            Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"LogicActivity\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"TAG_CHARGE\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            </span>mc.updateRemainCount(<span style=\"color:#9876aa;\">cardNo</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#9876aa;\">cardCount</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>intentResult.putExtra(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_CARD_CHARGE</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"0\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>setResult(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_CHARGE</span><span style=\"color:#cc7832;\">, </span>intentResult)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>finish()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            break;<br></span><span style=\"color:#cc7832;\">         case </span>CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_PAY</span>:<br>            Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"LogicActivity\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"TAG_PAY\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            </span>IcCard icCard = mc.readIcCard()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            </span>intentResult.putExtra(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_CARD_NO</span><span style=\"color:#cc7832;\">, </span>icCard.<span style=\"color:#9876aa;\">card_no</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>intentResult.putExtra(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_CARD_COUNT</span><span style=\"color:#cc7832;\">, </span>icCard.<span style=\"color:#9876aa;\">card_remain</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>intentResult.putExtra(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_CARD_DATE</span><span style=\"color:#cc7832;\">, </span>icCard.<span style=\"color:#9876aa;\">card_date</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>setResult(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_PAY</span><span style=\"color:#cc7832;\">, </span>intentResult)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>finish()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            break;<br></span><span style=\"color:#cc7832;\">         case </span>CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_READ_CARD_NO</span>:<br>            Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"LogicActivity\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"TAG_READ_CARD_NO\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            if </span>(!mc.isBlankCard()){<br>               intentResult.putExtra(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_BLANK_CARD</span><span style=\"color:#cc7832;\">, false</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">               </span>setResult(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_READ_CARD_NO</span><span style=\"color:#cc7832;\">, </span>intentResult)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">               </span>finish()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">               break;<br></span><span style=\"color:#cc7832;\">            </span>}<br><br>            String defaultCarNo = mc.readDefaultCarCardNo()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"LogicActivity\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;defaultCarNo: \" </span>+ defaultCarNo)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            </span>intentResult.putExtra(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_CARD_DEFAULT_NO</span><span style=\"color:#cc7832;\">, </span>defaultCarNo)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>setResult(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_READ_CARD_NO</span><span style=\"color:#cc7832;\">, </span>intentResult)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>finish()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            break;<br></span><span style=\"color:#cc7832;\">         case </span>CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_SELL</span>:<br>            Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"LogicActivity\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"TAG_SELL\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            </span>IcCard icCardSell = <span style=\"color:#cc7832;\">new </span>IcCard()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>icCardSell.<span style=\"color:#9876aa;\">card_no </span>= <span style=\"color:#9876aa;\">cardNo</span><span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>icCardSell.<span style=\"color:#9876aa;\">type </span>= <span style=\"color:#9876aa;\">cardType</span><span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>icCardSell.<span style=\"color:#9876aa;\">card_remain </span>= <span style=\"color:#9876aa;\">cardCount</span><span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>icCardSell.<span style=\"color:#9876aa;\">card_date </span>= <span style=\"color:#9876aa;\">cardDate</span><span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            </span>mc.makeCarCard(icCardSell)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            </span>intentResult.putExtra(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_CARD_MAKE</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"0\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>setResult(CardUtil.<span style=\"color:#9876aa;font-style:italic;\">TAG_SELL</span><span style=\"color:#cc7832;\">, </span>intentResult)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>finish()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">            break;<br></span><span style=\"color:#cc7832;\">         case </span>-<span style=\"color:#6897bb;\">1</span>:<br>            Log.<span style=\"font-style:italic;\">i</span>(<span style=\"color:#6a8759;\">\"LogicActivity\"</span><span style=\"color:#cc7832;\">, </span><span style=\"color:#6a8759;\">\"-1\"</span>)<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            </span>finish()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">            break;<br></span><span style=\"color:#cc7832;\">      </span>}<br><br>      mc.close()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\"><br></span><span style=\"color:#cc7832;\">   </span>} <span style=\"color:#cc7832;\">catch </span>(Exception e) {<br>      Toast.<span style=\"font-style:italic;\">makeText</span>(LogicActivity.<span style=\"color:#cc7832;\">this, </span><span style=\"color:#6a8759;\">\"</span><span style=\"color:#6a8759;font-family:\'宋体\';\">读取车主卡失败</span><span style=\"color:#6a8759;\">\"</span><span style=\"color:#cc7832;\">, </span>Toast.<span style=\"color:#9876aa;font-style:italic;\">LENGTH_SHORT</span>).show()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>finish()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">      </span>e.printStackTrace()<span style=\"color:#cc7832;\">;<br></span><span style=\"color:#cc7832;\">   </span>}<br>}</pre></pre><p><br></p><p><br></p><p><br></p>', '0', '2016', '11', '16', '2016-11-16 11:45:31', '0');
INSERT INTO `blog` VALUES ('test', 'test', 'sdaf', '0', '2016', '9', '30', '2016-09-22 15:55:13', '0');

-- ----------------------------
-- Table structure for `permission`
-- ----------------------------
DROP TABLE IF EXISTS `permission`;
CREATE TABLE `permission` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '权限id',
  `permission_name` varchar(32) DEFAULT NULL COMMENT '权限名',
  `permission_sign` varchar(128) DEFAULT NULL COMMENT '权限标识,程序中判断使用,如"user:create"',
  `description` varchar(256) DEFAULT NULL COMMENT '权限描述,UI界面显示使用',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 CHECKSUM=1 DELAY_KEY_WRITE=1 ROW_FORMAT=DYNAMIC COMMENT='权限表';

-- ----------------------------
-- Records of permission
-- ----------------------------
INSERT INTO `permission` VALUES ('1', '用户新增', 'user:create', null);

-- ----------------------------
-- Table structure for `role`
-- ----------------------------
DROP TABLE IF EXISTS `role`;
CREATE TABLE `role` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '角色id',
  `role_name` varchar(32) DEFAULT NULL COMMENT '角色名',
  `role_sign` varchar(128) DEFAULT NULL COMMENT '角色标识,程序中判断使用,如"admin"',
  `description` varchar(256) DEFAULT NULL COMMENT '角色描述,UI界面显示使用',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 CHECKSUM=1 DELAY_KEY_WRITE=1 ROW_FORMAT=DYNAMIC COMMENT='角色表';

-- ----------------------------
-- Records of role
-- ----------------------------
INSERT INTO `role` VALUES ('1', 'admin', 'admin', '管理员');

-- ----------------------------
-- Table structure for `role_permission`
-- ----------------------------
DROP TABLE IF EXISTS `role_permission`;
CREATE TABLE `role_permission` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '表id',
  `role_id` bigint(20) unsigned DEFAULT NULL COMMENT '角色id',
  `permission_id` bigint(20) unsigned DEFAULT NULL COMMENT '权限id',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 CHECKSUM=1 DELAY_KEY_WRITE=1 ROW_FORMAT=DYNAMIC COMMENT='角色与权限关联表';

-- ----------------------------
-- Records of role_permission
-- ----------------------------
INSERT INTO `role_permission` VALUES ('1', '2', '1');

-- ----------------------------
-- Table structure for `user`
-- ----------------------------
DROP TABLE IF EXISTS `user`;
CREATE TABLE `user` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '用户id',
  `username` varchar(50) DEFAULT NULL COMMENT '用户名',
  `password` char(64) DEFAULT NULL COMMENT '密码',
  `state` varchar(32) DEFAULT NULL COMMENT '状态',
  `create_time` datetime DEFAULT NULL COMMENT '创建时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 CHECKSUM=1 DELAY_KEY_WRITE=1 ROW_FORMAT=DYNAMIC COMMENT='用户表';

-- ----------------------------
-- Records of user
-- ----------------------------
INSERT INTO `user` VALUES ('1', 'xiass', 'smay1227', null, '2016-09-20 17:32:08');

-- ----------------------------
-- Table structure for `user_role`
-- ----------------------------
DROP TABLE IF EXISTS `user_role`;
CREATE TABLE `user_role` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '表id',
  `user_id` bigint(20) unsigned DEFAULT NULL COMMENT '用户id',
  `role_id` bigint(20) unsigned DEFAULT NULL COMMENT '角色id',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 CHECKSUM=1 DELAY_KEY_WRITE=1 ROW_FORMAT=DYNAMIC COMMENT='用户与角色关联表';

-- ----------------------------
-- Records of user_role
-- ----------------------------
INSERT INTO `user_role` VALUES ('1', '1', '1');
